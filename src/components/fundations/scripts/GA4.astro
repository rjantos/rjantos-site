---
const measurementId = import.meta.env.PUBLIC_GA4_ID ?? "G-91S7J11B9J";
const gtmId = import.meta.env.PUBLIC_GTM_ID ?? "GTM-W4WBD6BP";

// If GTM is present, prefer tracking through GTM to avoid duplicate page_views.
const loadDirectGa4 = Boolean(measurementId) && !gtmId;
---

{
  loadDirectGa4 && (
    <>
      <script
        async
        src={`https://www.googletagmanager.com/gtag/js?id=${measurementId}`}
      />
      <script is:inline define:vars={{ measurementId }}>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
          window.dataLayer.push(arguments);
        }
        gtag("js", new Date());
        gtag("config", measurementId, {
          anonymize_ip: true,
        });
      </script>
    </>
  )
}
