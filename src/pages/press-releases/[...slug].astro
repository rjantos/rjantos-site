---
// Fundations
import BaseLayout from "@/layouts/BaseLayout.astro";
import Text from "@/components/fundations/elements/Text.astro";
import Button from "@/components/fundations/elements/Button.astro";
import Wrapper from "@/components/fundations/containers/Wrapper.astro";
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";

export async function getStaticPaths() {
  const pressReleases = await getCollection("pressReleases");
  return pressReleases.map((release) => ({
    params: { slug: release.slug },
    props: { release },
  }));
}

type Props = {
  release: CollectionEntry<"pressReleases">;
};

const { release } = Astro.props as Props;
const { Content } = await release.render();
---

<BaseLayout>
  <section>
    <Wrapper variant="standard">
      <!-- Breadcrumb -->
      <nav class="mb-8">
        <a
          href="/press-and-media"
          class="text-accent-600 hover:text-accent-700 text-sm"
        >
          ← Back to Press and Media
        </a>
      </nav>

      <!-- Article Header -->
      <header class="mb-8">
        <div class="flex items-center gap-4 mb-4">
          <span
            class="bg-accent-100 text-accent-800 px-3 py-1 rounded-full text-sm font-medium"
          >
            {release.data.category}
          </span>
          <time
            class="text-base-600 text-sm"
            datetime={release.data.pubDate.toISOString()}
          >
            {
              release.data.pubDate.toLocaleDateString("en-US", {
                year: "numeric",
                month: "long",
                day: "numeric",
              })
            }
          </time>
        </div>

        <Text
          tag="h1"
          variant="textLG"
          class="order-last font-serif uppercase lg:order-none col-span-full lg:col-span-2 text-base-900 mb-4"
        >
          {release.data.title}
        </Text>

        <Text
          tag="p"
          variant="textBase"
          class="text-base-700 text-lg leading-relaxed"
        >
          {release.data.excerpt}
        </Text>
      </header>

      <!-- Article Content -->
      <article class="prose prose-lg max-w-none mb-12">
        <Content />
      </article>

      <!-- Tags -->
      {
        release.data.tags && release.data.tags.length > 0 && (
          <div class="mb-8">
            <Text
              tag="h3"
              variant="textSm"
              class="font-semibold text-base-900 mb-3"
            >
              Tags
            </Text>
            <div class="flex flex-wrap gap-2">
              {release.data.tags.map((tag) => (
                <span class="bg-base-100 text-base-800 px-3 py-1 rounded-full text-sm border border-base-200">
                  {tag}
                </span>
              ))}
            </div>
          </div>
        )
      }

      <!-- Share and Navigation -->
      <div class="border-t border-base-200 pt-8">
        <div
          class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"
        >
          <div class="flex gap-4">
            <Button
              isLink={true}
              href="/press-and-media"
              variant="muted"
              size="sm"
            >
              View All Press Releases
            </Button>
            <Button isLink={true} href="/contact" variant="accent" size="sm">
              Contact Us
            </Button>
          </div>

          <div class="text-sm text-base-600">
            <p>For media inquiries:</p>
            <p>Sarah Mitchell • press@carringtonlaw.com • (555) 123-4567</p>
          </div>
        </div>
      </div>
    </Wrapper>
  </section>
</BaseLayout>
